

@{
    /**/

    ViewBag.Title = "雲端藥歷下載運用及查詢系統";
    Layout = "~/Views/Shared/BaseLayoutPage.cshtml";
}


@section scripts
{


<div>
    <div id="header">
        <h1>輔大醫院</h1>
        <p>雲端下載藥歷運用及查詢</p>
    </div>
    <div id="Patient">
        <p1>
            請輸入病人身分證字號：
        </p1>
        <p2>
            <input id="Patienttextbox" data-bind="value: Patienttextbox" class="k-textbox" />
            <button id="buttonForSearchPatient" data-bind="click: create" class="k-button" 
                    style="background-color: #e7e7e7; color:#fff ;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;margin-left:8px">搜尋</button>
        </p2>
    </div>

    <div id="tabstrip">
        <ul>
            <li>雲端藥歷</li>
            <li>旅遊史</li>
            <li>過敏藥物</li>
            <li>檢查檢驗項目</li>
            <li>檢驗查報告</li>
            <li>手術明細記錄資料</li>
            <li>牙科處置及手術記錄</li>
            <li>復健治療項目</li>
        </ul>
        <div id="PHRCDRC">
            <div id="choose">
                <text>
                    醫院名稱
                </text>
                <select id="DropDownListForPHRCDRCHOSPITAL_ID" data-filter="contains"></select>
                <text>
                    藥品成份名稱
                </text>
                <select id="DropDownListForPHRCDRCDRUGCOMPCODENM" data-filter="contains"></select>
                <button id="ChartButton" class="k-button" style="color:#fff;font-family:'Microsoft YaHei UI';letter-spacing:2px;font-weight:bold;font-size:14px;">
                    顯示餘藥
                </button>
                <div id="ChartWindow">
                    <div id="chart"></div>
                </div>
                <button id="GraphicGiveDrugButton" class="k-button" style="color:#fff;font-family:'Microsoft YaHei UI';letter-spacing:2px;
                        font-weight:bold;font-size:14px;">
                    顯示用藥區間
                </button><br />
                <text>
                    來源設定
                </text>
                @*<select id="PHRCDRCmultiselect" data-placeholder="來源" style="width:370px;"></select>*@
                <select id="MultiSelectForPHRCDRC" data-placeholder="來源" style="width:370px;"></select>
            </div>
            <div id="WindowForGraphicGiveDrug">
                <h4>選擇顯示日期區間</h4>
                <input id="baseUnitHalfYears" name="baseUnit"
                       type="radio" value="halfyears" />
                <label for="baseUnitHalfYears"><text>半年</text></label>
                <input id="baseUnitThreeMonths" name="baseUnit"
                       type="radio" value="threemonths" />
                <label for="baseUnitThreeMonths"><text>三個月</text></label>
                <input id="baseUnitMonths" name="baseUnit"
                       type="radio" value="months" checked="checked" />
                <label for="baseUnitMonths"><text>一個月</text></label>
                <input id="baseUnitWeeks" name="baseUnit"
                       type="radio" value="weeks" />
                <label for="baseUnitWeekss"><text>一星期</text></label>
                <div id="RangeBarChart"></div>
            </div>
        </div>
        <div id="CMDTOCC">
        </div>
        <div id="CMDALLERGY">
            <div id="choose">
                <text>醫院名稱</text>
                <select id="dropdownlistForCMDALLERGYHOSPITAL_ID"></select>
                <text>過敏藥物</text>
                <select id="dropdownlistForCMDALLERGYDRUG"></select><br />
                <text>來源設定</text>
                @*<select id="CMDALLERGYmultiselect" data-placeholder="來源" style="width:370px;"></select>*@
                <select id="MultiSelectForCMDALLERGY" data-placeholder="來源" style="width:370px;"></select>
            </div>
        </div>
        <div id="CMDBDRC">
            <div id="choose">
                <text>醫院名稱</text>
                <select id="dropdownlistForCMDBDRCHOSPITAL_ID"></select>
                <text>就醫科別名稱</text>
                <select id="dropdownlistForCMDBDRCSECTION_NAMEC"></select>
                <text>檢查項目名稱</text>
                <select id="dropdownlistForCMDBDRCREC_NAME"></select>
                <text>健保名稱</text>
                <select id="dropdownlistForCMDBDRCNHI_NAME"></select>
                <text>執行日期</text>
                <select id="dropdownlistForCMDBDRCEXECUTE_DATE"></select><br />
                <text>來源設定</text>
                @*<select id="CMDBDRCmultiselect" data-placeholder="來源" style="width:370px;"></select>*@
                <select id="MultiSelectForCMDBDRC" data-placeholder="來源" style="width:370px;"></select>

            </div>
        </div>
        <div id="CMDEXAMREPORT">
            <div id="choose">
                <text>醫院名稱</text>
                <select id="DropDownListForCMDEXAMREPORTHOSPITAL_ID" data-filter="contains"></select>
                <text>就醫科別名稱</text>
                <select id="DropDownListForCMDEXAMREPORTSECTION_NAMEC" data-filter="contains"></select>
                <text>檢查檢驗類別名稱</text>
                <select id="DropDownListForCMDEXAMREPORTEXAM_TYPE_NAME" data-filter="contains"></select>
                <text>採檢/實際檢查日期</text>
                <select id="DropDownListForCMDEXAMREPORTEXECUTE_DATE" data-filter="contains"></select><br />
                <text>來源設定</text>
                @*<select id="CMDEXAMREPORTmultiselect" data-placeholder="來源" style="width:400px;"></select>*@
                <select id="MultiSelectForCMDEXAMREPORT" data-placeholder="來源" style="width:370px;"></select>
            </div>
        </div>
        <div id="OPERATION">
            <div id="choose">
                <text>醫院名稱</text>
                <select id="dropdownlistForOPERATIONHOSPITAL_ID"></select>
                <text>就醫科別名稱</text>
                <select id="dropdownlistForOPERATIONSECTION_NAMEC"></select>
                <text>檢查項目名稱</text>
                <select id="dropdownlistForOPERATIONREC_NAME"></select>
                <text>健保名稱</text>
                <select id="dropdownlistForOPERATIONNHI_NAME"></select>
                <text>執行日期</text>
                <select id="dropdownlistForOPERATIONEXECUTE_DATE"></select><br />
                <text>來源設定</text>
                @*<select id="OPERATIONmultiselect" data-placeholder="來源" style="width:370px;"></select>*@
                <select id="MultiSelectForOPERATION" data-placeholder="來源" style="width:370px;"></select>
            </div>
        </div>
        <div id="DENTISTRY">
            <div id="choose">
                <text>醫院名稱</text>
                <select id="dropdownlistForDENTISTRYHOSPITAL_ID"></select>
                <text>檢查項目名稱</text>
                <select id="dropdownlistForDENTISTRYREC_NAME"></select>
                <text>健保名稱</text>
                <select id="dropdownlistForDENTISTRYNHI_NAME"></select>
                <text>執行日期</text>
                <select id="dropdownlistForDENTISTRYEXECUTE_DATE"></select><br />
                <text>來源設定</text>
                @*<select id="DENTISTRYmultiselect" data-placeholder="來源" style="width:370px;"></select>*@
                <select id="MultiSelectForDENTISTRY" data-placeholder="來源" style="width:370px;"></select>
            </div>
        </div>
        <div id="REHABILITATION">
            <div id="choose">
                <text>醫院名稱</text>
                <select id="dropdownlistForREHABILITATIONHOSPITAL_ID"></select>
                <text>治療方式</text>
                <select id="dropdownlistForREHABILITATIONREC_CODE"></select>
                <text>健保名稱</text>
                <select id="dropdownlistForREHABILITATIONNHI_NAME"></select>
                <text>執行日期</text>
                <select id="dropdownlistForREHABILITATIONEXECUTE_DATE"></select><br />
                <text>來源設定</text>
                @*<select id="REHABILITATIONmultiselect" data-placeholder="來源" style="width:370px;"></select>*@
                <select id="MultiSelectForREHABILITATION" data-placeholder="來源" style="width:370px;"></select>
            </div>
        </div>
    </div>
</div>


    <script type="text/javascript">

        $(function () {

            //var tabstrip = $("#tabstrip").kendoTabStrip().data("kendoTabStrip");

            /*
             * TabStrip
             */

                var tabstrip = $("#tabstrip").kendoTabStrip({
                    animation: {
                        open: {
                            effects: "fadeIn"
                        }
                    }
            }).data("kendoTabStrip");


            ///<summary>
            ///程式說明：PHRCDRC Table裡DRUGSOURCE欄位的MultiSelect
            ///</summary>
            var PHRCDRCDRUGSOURCEMultiSelect = $("#MultiSelectForPHRCDRC").kendoMultiSelect({
                dataTextField: "Text",
                dataValueField: "Value",
                dataSource: {
                    transport: {
                        read: {
                            url: "GetPHRCDRCDRUGSOURCEMultiSelect",
                            type: "post",
                            dataType: "json"
                        }
                    }
                }

            }).data("kendoMultiSelect");

            ///<summary>
            ///程式說明：PHRCDRC Table裡DRUGSOURCE欄位的MultiSelecct Change
            ///</summary>
            $("#MultiSelectForPHRCDRC").change(function () {
                $("#PHRCDRC").kendoGrid({
                    dataSource: {
                        transport: {
                            read: {
                                type: "POST",
                                url: "PHRCDRCDRUGSOURCEMultiSelectChange",
                                data: {
                                    DrugSource: function () {
                                        return PHRCDRCDRUGSOURCEMultiSelect.value();
                                    },
                                    PatientId: function () {
                                        return $("#Patienttextbox").val();
                                    }
                                },
                                dataType: "json"
                            }
                        },
                        pageSize: 20,
                        serverPaging: true,
                        serverSorting: true
                    },
                    columnMenu: {
                        messages: {
                            columns: "顯示欄位設定",

                        }
                    },
                    columns: [
                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                        { field: "CASE_NO", title: "CASE_NO", hidden: true },
                        { field: "DRUGSOURCE", title: "門住診別" },
                        { field: "UDDATC", title: "ATC7代碼", hidden: true },
                        { field: "UDDATCNM", title: "ATC5名稱", hidden: true },
                        { field: "DRUGCOMPCODE", title: "藥品成份", hidden: true },
                        { field: "DRUGCOMPCODENM", title: "藥品成份名稱" },
                        { field: "UDNNHICODE", title: "藥品健保碼", hidden: true },
                        { field: "UDDMDPNAME", title: "螢幕顯示用藥名(MDP)", hidden: true },
                        { field: "BEGIN_DT", title: "開始日期 (門診：就醫日期)", template: '#= kendo.toString(kendo.parseDate(BEGIN_DT), "yyyy/MM/dd")#' },
                        { field: "END_DT", title: "結束日期", template: '#= kendo.toString(kendo.parseDate(END_DT), "yyyy/MM/dd")#' },
                        { field: "DSPQTY", title: "配出總量" },
                        { field: "DAYS", title: "天數" },
                        { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                        { field: "MAIN_DIAGNOSIS", title: "主診斷" },
                        { field: "ROUTE", title: "用法用量", hidden: true },
                        { field: "DOSEUNIT", title: "DOSEUNIT", hidden: true },
                        { field: "COMPLEX_MARK", title: "複方註記", hidden: true },
                        { field: "INSULOOKSEQ", title: "健保卡序", hidden: true },
                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                        { field: "ATC3_NAME", title: "ATC3_NAME", hidden: true },
                        { field: "HOSPITAL_ID_CHRONIC", title: "醫事機構代碼", hidden: true },
                        { field: "HOSPITAL_SNAME_CHRONIC", title: "醫事機構簡稱", hidden: true },
                    ], //columns的field對應到customer資料表的欄位
                });

            })

            ///<summary>
            ///程式說明：CMDALLERGY Table裡SOURCE欄位的MultiSelect
            ///</summary>
            var CMDALLERGYSOURCEMultiSelect = $("#MultiSelectForCMDALLERGY").kendoMultiSelect({
                dataTextField: "Text",
                dataValueField: "Value",
                dataSource: {
                    transport: {
                        read: {
                            url: "GetCMDALLERGYSOURCEMultiSelect",
                            type: "post",
                            dataType: "json"
                        }
                    }
                }

            }).data("kendoMultiSelect");


            ///<summary>
            ///程式說明：CMDALLERGY Table裡SOURCE欄位的MultiSelect Change
            ///</summary>
            $("#MultiSelectForCMDALLERGY").change(function () {
                $("#CMDALLERGY").kendoGrid({
                    dataSource: {
                        transport: {
                            read: {
                                type: "POST",
                                url: "CMDALLERGYSOURCEMultiSelectChange",
                                data: {
                                    SOURCE: function () {
                                        return CMDALLERGYSOURCEMultiSelect.value();
                                    },
                                    PatientId: function () {
                                        return $("#Patienttextbox").val();
                                    }
                                },
                                dataType: "json"
                            }
                        },
                        pageSize: 20,
                        serverPaging: true,
                        serverSorting: true
                    },
                    columnMenu: {
                        messages: {
                            columns: "顯示欄位設定",

                        }
                    },
                    columns: [
                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                        { field: "UPLOAD_DTTM", title: "CASE_NO", hidden: true },
                        { field: "SOURCE", title: "門住診別" },
                        { field: "SOURCE_IDNO", title: "ATC7代碼", hidden: true },
                        { field: "UPLOAD_MARK", title: "ATC5名稱", hidden: true },
                        { field: "DRUG", title: "過敏藥物" },
                        { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                    ], //columns的field對應到customer資料表的欄位
                });
            })

            ///<summary>
            ///程式說明：CMDBDRC Table裡SOURCE欄位的MultiSelect
            ///</summary>
            var CMDBDRCMultiSelect = $("#MultiSelectForCMDBDRC").kendoMultiSelect({
                dataTextField: "Text",
                dataValueField: "Value",
                dataSource: {
                    transport: {
                        read: {
                            url: "GetCMDBDRCSOURCEMultiSelect",
                            data: {
                                PatientId: function () {
                                    return $("#Patienttextbox").val();
                                }
                            },
                            type: "post",
                            dataType: "json"
                        }
                    }
                }

            }).data("kendoMultiSelect");


            ///<summary>
            ///程式說明：CMDBDRC Table裡SOURCE欄位的MultiSelecct Change
            ///</summary>
            $("#MultiSelectForCMDBDRC").change(function () {
                $("#CMDBDRC").kendoGrid({
                    dataSource: {
                        transport: {
                            read: {
                                type: "POST",
                                url: "CMDBDRCSOURCEMultiSelectChange",
                                data: {
                                    SOURCE: function () {
                                        return CMDBDRCMultiSelect.value();
                                    },
                                    PatientId: function () {
                                        return $("#Patienttextbox").val();
                                    }
                                },
                                dataType: "json"
                            }
                        },
                        pageSize: 20,
                        toolbarColumnMenu: true
                    },
                    columnMenu: {
                        messages: {
                            columns: "顯示欄位設定",

                        }
                    },
                    columns: [
                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                        { field: "REC_TYPE", title: "項目類別", hidden: true },
                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                        { field: "SOURCE", title: "來源" },
                        { field: "NHI_YM", title: "NHI_YM", hidden: true },
                        { field: "SECTION", title: "就醫科別代碼", hidden: true },
                        { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                        { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                        { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                        { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                        { field: "REC_NAME", title: "檢查項目名稱" },
                        { field: "NHI_CODE", title: "健保代碼", hidden: true },
                        { field: "NHI_NAME", title: "健保名稱診療部位" },
                        { field: "REGION", title: "部位", hidden: true },
                        { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                        { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                        { field: "QTY", title: "醫令總量", hidden: true },
                        { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                        { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                        { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                        { field: "OPDDATE", title: "診療部位", hidden: true },
                        { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                    ], //columns的field對應到customer資料表的欄位
                });
            })

            ///<summary>
            ///程式說明：CMDEXAMREPORT Table裡SOURCE欄位的MultiSelect
            ///</summary>
            var CMDEXAMREPORTMultiSelect = $("#MultiSelectForCMDEXAMREPORT").kendoMultiSelect({
                dataTextField: "Text",
                dataValueField: "Value",
                dataSource: {
                    transport: {
                        read: {
                            url: "GetCMDEXAMREPORTSOURCEMultiSelect",
                            data: {
                                PatientId: function () {
                                    return $("#Patienttextbox").val();
                                }
                            },
                            type: "post",
                            dataType: "json"
                        }
                    }
                }

            }).data("kendoMultiSelect");

            ///<summary>
            ///程式說明：CMDEXAMREPORT Table裡SOURCE欄位的MultiSelect Change
            ///</summary>
            $("#MultiSelectForCMDEXAMREPORT").change(function () {
                    $("#CMDEXAMREPORT").kendoGrid({
                        dataSource: {
                            transport: {
                                read: {
                                    type: "POST",
                                    url: "CMDEXAMREPORTSOURCEMultiSelectChange",
                                    data: {
                                        SOURCE: function () {
                                            return CMDEXAMREPORTMultiSelect.value();
                                        },
                                        PatientId: function () {
                                            return $("#Patienttextbox").val();
                                        }
                                    },
                                    dataType: "json"
                                }
                            },
                            pageSize: 20,
                            toolbarColumnMenu: true
                        },
                        columns: [
                            { field: "HOSPITAL_ID", title: "醫院代號" },
                            { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                            { field: "REC_NO", title: "自訂流水號", hidden: true },
                            { field: "EXAM_TYPE", title: "報告類別", hidden: true },
                            { field: "SOURCE", title: "來源" },
                            { field: "NHI_YM", title: "費用年月 YYY/MM(民國年)", hidden: true },
                            { field: "SECTION", title: "就醫科別代碼 例:00", hidden: true },
                            { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                            { field: "MAIN_DIAGNOSIS", title: "主診斷", hidden: true },
                            { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷主診斷名稱", hidden: true },
                            { field: "REGION", title: "診療部位", hidden: true },
                            { field: "EXAM_TYPE_CODE", title: "檢查檢驗類別", hidden: true },
                            { field: "EXAM_TYPE_NAME", title: "檢查檢驗類別名稱" },
                            { field: "NHI_CODE", title: "醫令代碼", hidden: true },
                            { field: "NHI_NAME", title: "醫令名稱" },
                            { field: "EXAM_NAME", title: "檢查檢驗項目", hidden: true },
                            { field: "EXAM_PROCEDURE", title: "檢查檢驗方法", hidden: true },
                            { field: "EXAM_REPORT01", title: "檢查檢驗結果(含參考值)", template: "#if(kendo.parseFloat(EXAM_REPORT01)<kendo.parseFloat(UNIT.substr(0,UNIT.indexOf('-')))){#<span style='color:blue;'>#=EXAM_REPORT01#</span>#}else if(kendo.parseFloat(EXAM_REPORT01)>kendo.parseFloat(UNIT.substr(UNIT.indexOf('-')+1,UNIT.length))){{#<span style='color:red;'>#=EXAM_REPORT01#</span>#}} else{#<span style='color:black;'>#=EXAM_REPORT01#</span>#}  #" },
                            { field: "UNIT", title: "檢查檢驗方法", hidden: true },
                            { field: "REFERENCE", title: "單位", hidden: true },
                            { field: "EXAM_REPORT02", title: "參考值" },
                            { field: "SPECIMEN", title: "檢體採檢方法/來源/類別", hidden: true },
                            { field: "ORDER_DATE", title: "開立醫令日期", hidden: true },
                            { field: "EXECUTE_DATE", title: "採檢/實際檢查日期" },
                            { field: "REPORT_DATE", title: "報告時間", hidden: true },
                            { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                            { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                            { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                            { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                            { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                            { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                            { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                            { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                            { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                            { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                            { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                            { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                            { field: "CERTIFICATION", title: "有無TAF認證C/1/Y/N" },
                            { field: "VIDEO_MATERIAL", title: "是否有影像資料/C/1/Y/N", template: '<a href="https://images.app.goo.gl/cki1yNBfgagqXsu47" target="_blank">#=VIDEO_MATERIAL#</a>' }
                        ], //columns的field對應到customer資料表的欄位
                    });

            })

            ///<summary>
            ///程式說明：OPERATION 裡SOURCE欄位的MultiSelect
            ///</summary>
            var OPERATIONMultiSelect = $("#MultiSelectForOPERATION").kendoMultiSelect({
                dataTextField: "Text",
                dataValueField: "Value",
                dataSource: {
                    transport: {
                        read: {
                            url: "GetOPERATIONSOURCEMultiSelect",
                            data: {
                                PatientId: function () {
                                    return $("#Patienttextbox").val();
                                }
                            },
                            type: "post",
                            dataType: "json"
                        }
                    }
                }

            }).data("kendoMultiSelect");

            ///<summary>
            ///程式說明：OPERATION Table裡SOURCE欄位的MultiSelecct Change
            ///</summary>
            $("#MultiSelectForOPERATION").change(function () {
                $("#OPERATION").kendoGrid({
                    dataSource: {
                        transport: {
                            read: {
                                type: "POST",
                                url: "OPERATIONSOURCEMultiSelectChange",
                                data: {
                                    SOURCE: function () {
                                        return OPERATIONMultiSelect.value();
                                    },
                                    PatientId: function () {
                                        return $("#Patienttextbox").val();
                                    }
                                },
                                dataType: "json"
                            }
                        },
                        pageSize: 20,
                        toolbarColumnMenu: true
                    },
                    columnMenu: {
                        messages: {
                            columns: "顯示欄位設定",

                        }
                    },
                    columns: [
                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                        { field: "REC_TYPE", title: "項目類別", hidden: true },
                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                        { field: "SOURCE", title: "來源" },
                        { field: "NHI_YM", title: "NHI_YM", hidden: true },
                        { field: "SECTION", title: "就醫科別代碼", hidden: true },
                        { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                        { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                        { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                        { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                        { field: "REC_NAME", title: "項目名稱" },
                        { field: "NHI_CODE", title: "健保代碼", hidden: true },
                        { field: "NHI_NAME", title: "健保名稱診療部位" },
                        { field: "REGION", title: "部位", hidden: true },
                        { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                        { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                        { field: "QTY", title: "醫令總量", hidden: true },
                        { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                        { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                        { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                        { field: "OPDDATE", title: "診療部位", hidden: true },
                        { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                    ], //columns的field對應到customer資料表的欄位
                });
            })


            ///<summary>
            ///程式說明：DENTISTRY 裡SOURCE欄位的MultiSelect
            ///</summary>
            var DENTISTRYMultiSelect = $("#MultiSelectForDENTISTRY").kendoMultiSelect({
                dataTextField: "Text",
                dataValueField: "Value",
                dataSource: {
                    transport: {
                        read: {
                            url: "GetDENTISTRYSOURCEMultiSelect",
                            data: {
                                PatientId: function () {
                                    return $("#Patienttextbox").val();
                                }
                            },
                            type: "post",
                            dataType: "json"
                        }
                    }
                }

            }).data("kendoMultiSelect");

            ///<summary>
            ///程式說明：DENTISTRY Table裡SOURCE欄位的MultiSelecct Change
            ///</summary>
            $("#MultiSelectForDENTISTRY").change(function () {
                $("#DENTISTRY").kendoGrid({
                    dataSource: {
                        transport: {
                            read: {
                                type: "POST",
                                url: "DENTISTRYSOURCEMultiSelectChange",
                                data: {
                                    SOURCE: function () {
                                        return DENTISTRYMultiSelect.value();
                                    },
                                    PatientId: function () {
                                        return $("#Patienttextbox").val();
                                    }
                                },
                                dataType: "json"
                            }
                        },
                        pageSize: 20,
                        toolbarColumnMenu: true
                    },
                    columnMenu: {
                        messages: {
                            columns: "顯示欄位設定",

                        }
                    },
                    columns: [
                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                        { field: "REC_TYPE", title: "項目類別", hidden: true },
                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                        { field: "SOURCE", title: "來源" },
                        { field: "NHI_YM", title: "NHI_YM", hidden: true },
                        { field: "SECTION", title: "就醫科別代碼", hidden: true },
                        { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                        { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                        { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                        { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                        { field: "REC_NAME", title: "項目名稱" },
                        { field: "NHI_CODE", title: "健保代碼", hidden: true },
                        { field: "NHI_NAME", title: "健保名稱診療部位" },
                        { field: "REGION", title: "部位", hidden: true },
                        { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                        { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                        { field: "QTY", title: "醫令總量", hidden: true },
                        { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                        { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                        { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                        { field: "OPDDATE", title: "診療部位", hidden: true },
                        { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                    ], //columns的field對應到customer資料表的欄位
                });
            })

            ///<summary>
            ///程式說明：REHABILITATION 裡SOURCE欄位的MultiSelect
            ///</summary>
            var REHABILITATIONMultiSelect = $("#MultiSelectForREHABILITATION").kendoMultiSelect({
                dataTextField: "Text",
                dataValueField: "Value",
                dataSource: {
                    transport: {
                        read: {
                            url: "GetREHABILITATIONSOURCEMultiSelect",
                            data: {
                                PatientId: function () {
                                    return $("#Patienttextbox").val();
                                }
                            },
                            type: "post",
                            dataType: "json"
                        }
                    }
                }

            }).data("kendoMultiSelect");


            ///<summary>
            ///程式說明：REHABILITATION Table裡SOURCE欄位的MultiSelecct Change
            ///</summary>
            $("#MultiSelectForREHABILITATION").change(function () {
                $("#REHABILITATION").kendoGrid({
                    dataSource: {
                        transport: {
                            read: {
                                type: "POST",
                                url: "REHABILITATIONSOURCEMultiSelectChange",
                                data: {
                                    SOURCE: function () {
                                        return REHABILITATIONMultiSelect.value();
                                    },
                                    PatientId: function () {
                                        return $("#Patienttextbox").val();
                                    }
                                },
                                dataType: "json"
                            }
                        },
                        pageSize: 20,
                        toolbarColumnMenu: true
                    },
                    columnMenu: {
                        messages: {
                            columns: "顯示欄位設定",

                        }
                    },
                    columns: [
                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                        { field: "REC_TYPE", title: "項目類別", hidden: true },
                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                        { field: "SOURCE", title: "來源" },
                        { field: "NHI_YM", title: "NHI_YM", hidden: true },
                        { field: "SECTION", title: "就醫科別代碼", hidden: true },
                        { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                        { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                        { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                        { field: "REC_CODE", title: "治療方式" },
                        { field: "REC_NAME", title: "項目名稱", hidden: true },
                        { field: "NHI_CODE", title: "健保代碼", hidden: true },
                        { field: "NHI_NAME", title: "健保名稱診療部位" },
                        { field: "REGION", title: "部位", hidden: true },
                        { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                        { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                        { field: "QTY", title: "醫令總量", hidden: true },
                        { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                        { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                        { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                        { field: "OPDDATE", title: "診療部位", hidden: true },
                        { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                    ], //columns的field對應到customer資料表的欄位
                });
            })


            ///<summary>
            ///程式說明：搜尋病人資料
            ///</summary>

            ///<summary>
            ///程式說明：病人身分證號改變後，按下搜尋按鈕執行以下方法
            ///</summary>
            $("#Patienttextbox").change(function () {
                $("#buttonForSearchPatient").kendoButton({
                    click: function () {
                        $("#MultiSelectForPHRCDRC").data("kendoMultiSelect").value("");
                        $("#MultiSelectForCMDALLERGY").data("kendoMultiSelect").value("");
                        $("#MultiSelectForCMDBDRC").data("kendoMultiSelect").value("");
                        $("#MultiSelectForCMDEXAMREPORT").data("kendoMultiSelect").value("");
                        $("#MultiSelectForOPERATION").data("kendoMultiSelect").value("");
                        $("#MultiSelectForDENTISTRY").data("kendoMultiSelect").value("");
                        $("#MultiSelectForREHABILITATION").data("kendoMultiSelect").value("");

                        ///<summary>
                        ///程式說明：點選病人搜尋後顯示第一個頁籤
                        ///</summary>
                        tabstrip.select("li:first");

                        ///<summary>
                        ///程式說明：顯示特定病人PHRCDRC Grid
                        ///</summary>
                        $("#PHRCDRC").kendoGrid({
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "POST",
                                        url: "PHRCDRCPatientIdChange",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        dataType: "json"
                                    }
                                },
                                pageSize: 20,
                                serverPaging: true,
                                serverSorting: true,
                            },
                            sortable: true,
                            columnMenu: {
                                messages: {
                                    columns: "顯示欄位設定",

                                }
                            },
                            columns: [
                                { field: "HOSPITAL_ID", title: "醫院名稱" },
                                { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                { field: "REC_NO", title: "自訂流水號", hidden: true },
                                { field: "CASE_NO", title: "CASE_NO", hidden: true },
                                { field: "DRUGSOURCE", title: "門住診別" },
                                { field: "UDDATC", title: "ATC7代碼", hidden: true },
                                { field: "UDDATCNM", title: "ATC5名稱", hidden: true },
                                { field: "DRUGCOMPCODE", title: "藥品成份", hidden: true },
                                { field: "DRUGCOMPCODENM", title: "藥品成份名稱" },
                                { field: "UDNNHICODE", title: "藥品健保碼", hidden: true },
                                { field: "UDDMDPNAME", title: "螢幕顯示用藥名(MDP)", hidden: true },
                                { field: "BEGIN_DT", title: "開始日期 (門診：就醫日期)", template: '#= kendo.toString(kendo.parseDate(BEGIN_DT), "yyyy/MM/dd")#' },
                                { field: "END_DT", title: "結束日期", template: '#= kendo.toString(kendo.parseDate(END_DT), "yyyy/MM/dd")#' },
                                { field: "DSPQTY", title: "配出總量" },
                                { field: "DAYS", title: "天數" },
                                { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                { field: "MAIN_DIAGNOSIS", title: "主診斷" },
                                { field: "ROUTE", title: "用法用量", hidden: true },
                                { field: "DOSEUNIT", title: "DOSEUNIT", hidden: true },
                                { field: "COMPLEX_MARK", title: "複方註記", hidden: true },
                                { field: "INSULOOKSEQ", title: "健保卡序", hidden: true },
                                { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                { field: "ATC3_NAME", title: "ATC3_NAME", hidden: true },
                                { field: "HOSPITAL_ID_CHRONIC", title: "醫事機構代碼", hidden: true },
                                { field: "HOSPITAL_SNAME_CHRONIC", title: "醫事機構簡稱", hidden: true },
                            ]
                        });

                        ///<summary>
                        ///程式說明：顯示特定病人CMDTOCC Grid
                        ///</summary>
                        $("#CMDTOCC").kendoGrid({
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "POST",
                                        url: "CMDTOCCPatientIdChange",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        dataType: "json"
                                    }
                                },
                                pageSize: 20,
                                serverPaging: true,
                                serverSorting: true
                            },
                            columnMenu: {
                                messages: {
                                    columns: "顯示欄位設定",

                                }
                            },
                            columns: [
                                { field: "HOSPITAL_ID", title: "醫院名稱", hidden: true },
                                { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                { field: "TOCCMSG", title: "特定地區旅遊及接觸史查詢資料", headerAttributes: { style: "text-align:center" }, attributes: { style: "text-align:center" } },
                                { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                            ], //columns的field對應到customer資料表的欄位
                        });

                        ///<summary>
                        ///程式說明：顯示特定病人CMDALLERGY Grid
                        ///</summary>
                        $("#CMDALLERGY").kendoGrid({
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "POST",
                                        url: "CMDALLERGYPatientIdChange",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        dataType: "json"
                                    }
                                },
                                pageSize: 20,
                                serverPaging: true,
                                serverSorting: true
                            },
                            sortable: true,
                            columnMenu: {
                                messages: {
                                    columns: "顯示欄位設定",

                                }
                            },
                            columns: [
                                { field: "HOSPITAL_ID", title: "醫院名稱" },
                                { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                { field: "REC_NO", title: "自訂流水號", hidden: true },
                                { field: "UPLOAD_DTTM", title: "CASE_NO", hidden: true },
                                { field: "SOURCE", title: "門住診別" }, 
                                { field: "SOURCE_IDNO", title: "ATC7代碼", hidden: true },
                                { field: "UPLOAD_MARK", title: "ATC5名稱", hidden: true },
                                { field: "DRUG", title: "過敏藥物" },
                                { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                            ], //columns的field對應到customer資料表的欄位
                            width: '1500'
                        });

                        ///<summary>
                        ///程式說明：顯示特定病人CMDBDRC Grid
                        ///</summary>
                        $("#CMDBDRC").kendoGrid({
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "POST",
                                        url: "CMDBDRCPatientIdChange",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        dataType: "json"
                                    }
                                },
                                pageSize: 20,
                                serverPaging: true,
                                serverSorting: true
                            },
                            sortable: true,
                            columnMenu: {
                                messages: {
                                    columns: "顯示欄位設定",

                                }
                            },
                            columns: [
                                { field: "HOSPITAL_ID", title: "醫院名稱"},
                                { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                { field: "REC_TYPE", title: "項目類別", hidden: true  },
                                { field: "REC_NO", title: "自訂流水號", hidden: true },
                                { field: "SOURCE", title: "來源"},
                                { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱"},
                                { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                { field: "REC_NAME", title: "檢查項目名稱" },
                                { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                { field: "NHI_NAME", title: "健保名稱診療部位" },   
                                { field: "REGION", title: "部位", hidden: true },
                                { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                { field: "QTY", title: "醫令總量", hidden: true },
                                { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                { field: "OPDDATE", title: "診療部位", hidden: true },
                                { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                            ], //columns的field對應到customer資料表的欄位

                        });

                        ///<summary>
                        ///程式說明：顯示特定病人OPERATION Grid
                        ///</summary>
                        $("#OPERATION").kendoGrid({
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "POST",
                                        url: "OPERATIONPatientIdChange",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        dataType: "json"
                                    }
                                },
                                pageSize: 20,
                                serverPaging: true,
                                serverSorting: true
                            },
                            sortable: true,
                            columnMenu: {
                                messages: {
                                    columns: "顯示欄位設定",

                                }
                            },
                            columns: [
                                { field: "HOSPITAL_ID", title: "醫院名稱" },
                                { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                { field: "REC_TYPE", title: "項目類別", hidden: true },
                                { field: "REC_NO", title: "自訂流水號", hidden: true },
                                { field: "SOURCE", title: "來源" },
                                { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱"},
                                { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                { field: "REC_NAME", title: "項目名稱" },
                                { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                { field: "NHI_NAME", title: "健保名稱診療部位" },
                                { field: "REGION", title: "部位", hidden: true },
                                { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                { field: "QTY", title: "醫令總量", hidden: true },
                                { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                { field: "OPDDATE", title: "診療部位", hidden: true },
                                { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                            ], //columns的field對應到customer資料表的欄位

                        });

                        ///<summary>
                        ///程式說明：顯示特定病人DENTISTRY Grid
                        ///</summary>
                        $("#DENTISTRY").kendoGrid({
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "POST",
                                        url: "DENTISTRYPatientIdChange",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        dataType: "json"
                                    }
                                },
                                pageSize: 20,
                                serverPaging: true,
                                serverSorting: true
                            },
                            sortable: true,
                            columnMenu: {
                                messages: {
                                    columns: "顯示欄位設定",

                                }
                            },
                            columns: [
                                { field: "HOSPITAL_ID", title: "醫院名稱" },
                                { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                { field: "REC_TYPE", title: "項目類別", hidden: true },
                                { field: "REC_NO", title: "自訂流水號", hidden: true },
                                { field: "SOURCE", title: "來源" },
                                { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱"},
                                { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                { field: "REC_NAME", title: "項目名稱" },
                                { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                { field: "NHI_NAME", title: "健保名稱診療部位" },
                                { field: "REGION", title: "部位", hidden: true },
                                { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                { field: "QTY", title: "醫令總量", hidden: true },
                                { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                { field: "OPDDATE", title: "診療部位", hidden: true },
                                { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                            ], //columns的field對應到customer資料表的欄位

                        });

                        ///<summary>
                        ///程式說明：顯示特定病人REHABILITATION Grid
                        ///</summary>
                        $("#REHABILITATION").kendoGrid({
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "POST",
                                        url: "REHABILITATIONPatientIdChange",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        dataType: "json"
                                    }
                                },
                                pageSize: 20,
                                serverPaging: true,
                                serverSorting: true
                            },
                            columnMenu: {
                                messages: {
                                    columns: "顯示欄位設定",

                                }
                            },
                            sortable: true,
                            columns: [
                                { field: "HOSPITAL_ID", title: "醫院名稱" },
                                { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                { field: "REC_TYPE", title: "項目類別", hidden: true },
                                { field: "REC_NO", title: "自訂流水號", hidden: true },
                                { field: "SOURCE", title: "來源" },
                                { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                { field: "REC_CODE", title: "治療方式"},
                                { field: "REC_NAME", title: "項目名稱", hidden: true },
                                { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                { field: "NHI_NAME", title: "健保名稱診療部位" },
                                { field: "REGION", title: "部位", hidden: true },
                                { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                { field: "QTY", title: "醫令總量", hidden: true },
                                { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                { field: "OPDDATE", title: "診療部位", hidden: true },
                                { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                            ], //columns的field對應到customer資料表的欄位

                        });

                        ///<summary>
                        ///程式說明：顯示特定病人CMDEXAMREPORT Grid
                        ///</summary>p
                        $("#CMDEXAMREPORT").kendoGrid({
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "POST",
                                        url: "CMDEXAMREPORTPatientIdChange",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        dataType: "json"
                                    }
                                },
                                pageSize: 20,
                                serverPaging: true,
                                serverSorting: true
                            },
                            sortable: true,
                            columnMenu: {
                                messages: {
                                    columns: "顯示欄位設定",

                                }
                            },
                            columns: [
                                { field: "HOSPITAL_ID", title: "醫院名稱" },
                                { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                { field: "REC_NO", title: "自訂流水號", hidden: true },
                                { field: "EXAM_TYPE", title: "報告類別", hidden: true },
                                { field: "SOURCE", title: "來源" },
                                { field: "NHI_YM", title: "費用年月 YYY/MM(民國年)", hidden: true },
                                { field: "SECTION", title: "就醫科別代碼 例:00", hidden: true },
                                { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                { field: "MAIN_DIAGNOSIS", title: "主診斷", hidden: true },
                                { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷主診斷名稱", hidden: true },
                                { field: "REGION", title: "診療部位", hidden: true },
                                { field: "EXAM_TYPE_CODE", title: "檢查檢驗類別", hidden: true },
                                { field: "EXAM_TYPE_NAME", title: "檢查檢驗類別名稱" },
                                { field: "NHI_CODE", title: "醫令代碼", hidden: true },
                                { field: "NHI_NAME", title: "醫令名稱" },
                                { field: "EXAM_NAME", title: "檢查檢驗項目", hidden: true },
                                { field: "EXAM_PROCEDURE", title: "檢查檢驗方法", hidden: true },
                                {
                                    field: "EXAM_REPORT01", title: "檢查檢驗結果(含參考值)",
                                    template: "#if(kendo.parseFloat(EXAM_REPORT01)<kendo.parseFloat(UNIT.substr(0,UNIT.indexOf('-')))) \
                                    { #<span style = 'color:blue;' >#=EXAM_REPORT01#</span >#}else if(kendo.parseFloat(EXAM_REPORT01)> \
                                    kendo.parseFloat(UNIT.substr(UNIT.indexOf('-') + 1, UNIT.length))){ { #<span style='color:red;'>#=EXAM_REPORT01#</span># } } \
                                    else { #< span style='color:black;' >#=EXAM_REPORT01#</span>#} #"
                                },
                                { field: "UNIT", title: "檢查檢驗方法", hidden: true },
                                { field: "REFERENCE", title: "單位", hidden: true },
                                { field: "EXAM_REPORT02", title: "參考值"},
                                { field: "SPECIMEN", title: "檢體採檢方法/來源/類別", hidden: true },
                                { field: "ORDER_DATE", title: "開立醫令日期", hidden: true },
                                { field: "EXECUTE_DATE", title: "採檢/實際檢查日期" },
                                { field: "REPORT_DATE", title: "報告時間", hidden: true },
                                { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                { field: "CERTIFICATION", title: "有無TAF認證C/1/Y/N" },
                                {
                                    field: "VIDEO_MATERIAL", title: "是否有影像資料/C/1/Y/N", template: '<a href="https://images.app.goo.gl/cki1yNBfgagqXsu47" \
                                            target="_blank">#=VIDEO_MATERIAL#</a>' },
                            ], //columns的field對應到customer資料表的欄位
                            width: '1500'
                        });


                        /*
                         * DropDownList
                         */
                        ///<summary>
                        ///程式說明：PHRCDRC Table裡HOSPITAL_ID欄位的DropDownList
                        ///</summary>
                        $("#DropDownListForPHRCDRCHOSPITAL_ID").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetPHRCDRCHOSPITAL_IDDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：PHRCDRC Table裡DRUGSOURCE欄位的MultiSelect
                        ///</summary>
                        var PHRCDRCDRUGSOURCEmultiselect = $("#PHRCDRCmultiselect").kendoMultiSelect({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetPHRCDRCDRUGSOURCEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            }

                        }).data("kendoMultiSelect");


                        ///<summary>
                        ///程式說明：PHRCDRC Table裡DRUGCOMPCODENM欄位的DropDownList
                        ///</summary>
                        $("#DropDownListForPHRCDRCDRUGCOMPCODENM").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetPHRCDRCDRUGCOMPCODENMDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡HOSPITAL_ID欄位的DropDownList
                        ///</summary>
                        $("#DropDownListForCMDEXAMREPORTHOSPITAL_ID").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDEXAMREPORTHOSPITAL_IDDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡SECTION_NAMEC欄位的DropDownList
                        ///</summary>
                        $("#DropDownListForCMDEXAMREPORTSECTION_NAMEC").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDEXAMREPORTSECTION_NAMECDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡EXAM_TYPE_NAME欄位的DropDownList
                        ///</summary>
                        $("#DropDownListForCMDEXAMREPORTEXAM_TYPE_NAME").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDEXAMREPORTEXAM_TYPE_NAMEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡EXECUTE_DATE欄位的DropDownList
                        ///</summary>
                        $("#DropDownListForCMDEXAMREPORTEXECUTE_DATE").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDEXAMREPORTEXECUTE_DATEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡SOURCE欄位的MultiSelect
                        ///</summary>
                        var CMDEXAMREPORTmultiselect = $("#CMDEXAMREPORTmultiselect").kendoMultiSelect({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDEXAMREPORTSOURCEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            }

                        }).data("kendoMultiSelect");

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡HOSPITAL_ID欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForCMDBDRCHOSPITAL_ID").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDBDRCHOSPITAL_IDDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡SECTION_NAMEC欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForCMDBDRCSECTION_NAMEC").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDBDRCSECTION_NAMECDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡REC_NAME欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForCMDBDRCREC_NAME").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDBDRCREC_NAMEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡NHI_NAME欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForCMDBDRCNHI_NAME").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDBDRCNHI_NAMEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡EXECUTE_DATE欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForCMDBDRCEXECUTE_DATE").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDBDRCEXECUTE_DATEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡SOURCE欄位的MultiSelect
                        ///</summary>
                        var CMDBDRCmultiselect = $("#CMDBDRCmultiselect").kendoMultiSelect({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDBDRCSOURCEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            }

                        }).data("kendoMultiSelect");

                        ///<summary>
                        ///程式說明：OPERATION Table裡HOSPITAL_ID欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForOPERATIONHOSPITAL_ID").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetOPERATIONHOSPITAL_IDDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：OPERATION Table裡SECTION_NAMEC欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForOPERATIONSECTION_NAMEC").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetOPERATIONSECTION_NAMECDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：OPERATION Table裡REC_NAME欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForOPERATIONREC_NAME").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetOPERATIONREC_NAMEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：OPERATION Table裡NHI_NAME欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForOPERATIONNHI_NAME").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetOPERATIONNHI_NAMEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：OPERATION Table裡EXECUTE_DATE欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForOPERATIONEXECUTE_DATE").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetOPERATIONEXECUTE_DATEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：OPERATION 裡SOURCE欄位的MultiSelect
                        ///</summary>
                        var OPERATIONmultiselect = $("#OPERATIONmultiselect").kendoMultiSelect({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetOPERATIONSOURCEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            }

                        }).data("kendoMultiSelect");

                        ///<summary>
                        ///程式說明：DENTISTRY Table裡HOSPITAL_ID欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForDENTISTRYHOSPITAL_ID").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetDENTISTRYHOSPITAL_IDDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：DENTISTRY Table裡REC_NAME欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForDENTISTRYREC_NAME").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetDENTISTRYREC_NAMEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：DENTISTRY Table裡NHI_NAME欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForDENTISTRYNHI_NAME").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetDENTISTRYNHI_NAMEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：DENTISTRY Table裡EXECUTE_DATE欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForDENTISTRYEXECUTE_DATE").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetDENTISTRYEXECUTE_DATEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：DENTISTRY 裡SOURCE欄位的MultiSelect
                        ///</summary>
                        var DENTISTRYmultiselect = $("#DENTISTRYmultiselect").kendoMultiSelect({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetDENTISTRYSOURCEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            }

                        }).data("kendoMultiSelect");


                        ///<summary>
                        ///程式說明：REHABILITATION Table裡HOSPITAL_ID欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForREHABILITATIONHOSPITAL_ID").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetREHABILITATIONHOSPITAL_IDDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：REHABILITATION Table裡REC_CODE欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForREHABILITATIONREC_CODE").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetREHABILITATIONREC_CODEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：REHABILITATION Table裡NHI_NAME欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForREHABILITATIONNHI_NAME").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetREHABILITATIONNHI_NAMEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：REHABILITATION Table裡EXECUTE_DATE欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForREHABILITATIONEXECUTE_DATE").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetREHABILITATIONEXECUTE_DATEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });


                        ///<summary>
                        ///程式說明：REHABILITATION 裡SOURCE欄位的MultiSelect
                        ///</summary>
                        var REHABILITATIONmultiselect = $("#REHABILITATIONmultiselect").kendoMultiSelect({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetREHABILITATIONSOURCEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            }

                        }).data("kendoMultiSelect");


                        ///<summary>
                        ///程式說明：CMDALLERGY Table裡HOSPITAL_ID欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForCMDALLERGYHOSPITAL_ID").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDALLERGYHOSPITAL_IDDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        ///<summary>
                        ///程式說明：CMDALLERGY Table裡SOURCE欄位的MultiSelect
                        ///</summary>
                        var CMDALLERGYmultiselect = $("#CMDALLERGYmultiselect").kendoMultiSelect({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDALLERGYSOURCEDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            }

                        }).data("kendoMultiSelect");

                        ///<summary>
                        ///程式說明：CMDALLERGY Table裡DRUG欄位的DropDownList
                        ///</summary>
                        $("#dropdownlistForCMDALLERGYDRUG").kendoDropDownList({
                            dataTextField: "Text",
                            dataValueField: "Value",
                            optionLabel: "請選擇",
                            optionLabelTemplate: '<span style="font-weight:bold">請選擇</span>',
                            dataSource: {
                                transport: {
                                    read: {
                                        url: "GetCMDALLERGYDRUGDropDownList",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        type: "post",
                                        dataType: "json"
                                    }
                                }
                            },
                            filter: "contains"

                        });

                        /*
                         * DropDownListChange
                         */

                        ///<summary>
                        ///程式說明：PHRCDRC Table裡HOSPITAL_ID欄位的DropDownList Change
                        ///</summary>
                        $("#DropDownListForPHRCDRCHOSPITAL_ID").change(function () {
                            //debugger
                            HOSPITAL_ID = $(this).val();
                            $("#PHRCDRC").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "PHRCDRCHOSPITAL_IDChange",
                                            data: {
                                                "HOSPITAL_ID": HOSPITAL_ID,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    serverPaging: true,
                                    serverSorting: true,
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "CASE_NO", title: "CASE_NO", hidden: true },
                                    { field: "DRUGSOURCE", title: "門住診別" },
                                    { field: "UDDATC", title: "ATC7代碼", hidden: true },
                                    { field: "UDDATCNM", title: "ATC5名稱", hidden: true },
                                    { field: "DRUGCOMPCODE", title: "藥品成份", hidden: true },
                                    { field: "DRUGCOMPCODENM", title: "藥品成份名稱" },
                                    { field: "UDNNHICODE", title: "藥品健保碼", hidden: true },
                                    { field: "UDDMDPNAME", title: "螢幕顯示用藥名(MDP)", hidden: true },
                                    { field: "BEGIN_DT", title: "開始日期 (門診：就醫日期)", template: '#= kendo.toString(kendo.parseDate(BEGIN_DT), "yyyy/MM/dd")#' },
                                    { field: "END_DT", title: "結束日期", template: '#= kendo.toString(kendo.parseDate(END_DT), "yyyy/MM/dd")#' },
                                    { field: "DSPQTY", title: "配出總量" },
                                    { field: "DAYS", title: "天數" },
                                    { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷" },
                                    { field: "ROUTE", title: "用法用量", hidden: true },
                                    { field: "DOSEUNIT", title: "DOSEUNIT", hidden: true },
                                    { field: "COMPLEX_MARK", title: "複方註記", hidden: true },
                                    { field: "INSULOOKSEQ", title: "健保卡序", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "ATC3_NAME", title: "ATC3_NAME", hidden: true },
                                    { field: "HOSPITAL_ID_CHRONIC", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_CHRONIC", title: "醫事機構簡稱", hidden: true },

                                ]
                            });
                        })

                        ///<summary>
                        ///程式說明：PHRCDRC Table裡DRUGSOURCE欄位的MultiSelecct Change
                        ///</summary>
                        $("#PHRCDRCmultiselect").change(function () {
                                $("#PHRCDRC").kendoGrid({
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "POST",
                                                url: "PHRCDRCDRUGSOURCEMultiSelectChange",
                                                data: {
                                                    DrugSource: function () {
                                                        return PHRCDRCDRUGSOURCEmultiselect.value();
                                                    },
                                                    PatientId: function () {
                                                        return $("#Patienttextbox").val();
                                                    }
                                                },
                                                dataType: "json"
                                            }
                                        },
                                        pageSize: 20,
                                        serverPaging: true,
                                        serverSorting: true
                                    },
                                    columnMenu: {
                                        messages: {
                                            columns: "顯示欄位設定",

                                        }
                                    },
                                    columns: [
                                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                                        { field: "CASE_NO", title: "CASE_NO", hidden: true },
                                        { field: "DRUGSOURCE", title: "門住診別" },
                                        { field: "UDDATC", title: "ATC7代碼", hidden: true },
                                        { field: "UDDATCNM", title: "ATC5名稱", hidden: true },
                                        { field: "DRUGCOMPCODE", title: "藥品成份", hidden: true },
                                        { field: "DRUGCOMPCODENM", title: "藥品成份名稱" },
                                        { field: "UDNNHICODE", title: "藥品健保碼", hidden: true },
                                        { field: "UDDMDPNAME", title: "螢幕顯示用藥名(MDP)", hidden: true },
                                        { field: "BEGIN_DT", title: "開始日期 (門診：就醫日期)", template: '#= kendo.toString(kendo.parseDate(BEGIN_DT),"yyyy/MM/dd")#'},
                                        { field: "END_DT", title: "結束日期", template: '#= kendo.toString(kendo.parseDate(END_DT), "yyyy/MM/dd")#' },
                                        { field: "DSPQTY", title: "配出總量" },
                                        { field: "DAYS", title: "天數" },
                                        { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                        { field: "MAIN_DIAGNOSIS", title: "主診斷" },
                                        { field: "ROUTE", title: "用法用量", hidden: true },
                                        { field: "DOSEUNIT", title: "DOSEUNIT", hidden: true },
                                        { field: "COMPLEX_MARK", title: "複方註記", hidden: true },
                                        { field: "INSULOOKSEQ", title: "健保卡序", hidden: true },
                                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                        { field: "ATC3_NAME", title: "ATC3_NAME", hidden: true },
                                        { field: "HOSPITAL_ID_CHRONIC", title: "醫事機構代碼", hidden: true },
                                        { field: "HOSPITAL_SNAME_CHRONIC", title: "醫事機構簡稱", hidden: true },
                                    ], //columns的field對應到customer資料表的欄位
                                });

                        })


                        ///<summary>
                        ///程式說明：PHRCDRC Table裡DRUGCOMPCODENM欄位的DropDownList Change
                        ///</summary>
                        $("#DropDownListForPHRCDRCDRUGCOMPCODENM").change(function () {
                            //debugger
                            DRUGCOMPCODENM = $(this).val();
                            $("#PHRCDRC").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "PHRCDRCDRUGCOMPCODENMChange",
                                            data: {
                                                "DRUGCOMPCODENM": DRUGCOMPCODENM,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    serverPaging: true,
                                    serverSorting: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "CASE_NO", title: "CASE_NO", hidden: true },
                                    { field: "DRUGSOURCE", title: "門住診別" },
                                    { field: "UDDATC", title: "ATC7代碼", hidden: true },
                                    { field: "UDDATCNM", title: "ATC5名稱", hidden: true },
                                    { field: "DRUGCOMPCODE", title: "藥品成份", hidden: true },
                                    { field: "DRUGCOMPCODENM", title: "藥品成份名稱" },
                                    { field: "UDNNHICODE", title: "藥品健保碼", hidden: true },
                                    { field: "UDDMDPNAME", title: "螢幕顯示用藥名(MDP)", hidden: true },
                                    { field: "BEGIN_DT", title: "開始日期 (門診：就醫日期)", template: '#= kendo.toString(kendo.parseDate(BEGIN_DT), "yyyy/MM/dd")#' },
                                    { field: "END_DT", title: "結束日期", template: '#= kendo.toString(kendo.parseDate(END_DT), "yyyy/MM/dd")#' },
                                    { field: "DSPQTY", title: "配出總量" },
                                    { field: "DAYS", title: "天數" },
                                    { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷" },
                                    { field: "ROUTE", title: "用法用量", hidden: true },
                                    { field: "DOSEUNIT", title: "DOSEUNIT", hidden: true },
                                    { field: "COMPLEX_MARK", title: "複方註記", hidden: true },
                                    { field: "INSULOOKSEQ", title: "健保卡序", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "ATC3_NAME", title: "ATC3_NAME", hidden: true },
                                    { field: "HOSPITAL_ID_CHRONIC", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_CHRONIC", title: "醫事機構簡稱", hidden: true },


                                ]
                            });
                        })


                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡HOSPITAL_ID欄位的DropDownList Change
                        ///</summary>
                        $("#DropDownListForCMDEXAMREPORTHOSPITAL_ID").change(function () {
                            //debugger
                            HOSPITAL_ID = $(this).val();
                            $("#CMDEXAMREPORT").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDEXAMREPORTHOSPITAL_IDChange",
                                            data: {
                                                "HOSPITAL_ID": HOSPITAL_ID,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    serverPaging: true,
                                    serverSorting: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "EXAM_TYPE", title: "報告類別", hidden: true },
                                    { field: "SOURCE", title: "來源:本院門診or他院門診" },
                                    { field: "NHI_YM", title: "費用年月 YYY/MM(民國年)", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼 例:00", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷主診斷名稱", hidden: true },
                                    { field: "REGION", title: "診療部位", hidden: true },
                                    { field: "EXAM_TYPE_CODE", title: "檢查檢驗類別", hidden: true },
                                    { field: "EXAM_TYPE_NAME", title: "檢查檢驗類別名稱" },
                                    { field: "NHI_CODE", title: "醫令代碼", hidden: true },
                                    { field: "NHI_NAME", title: "醫令名稱" },
                                    { field: "EXAM_NAME", title: "檢查檢驗項目", hidden: true },
                                    { field: "EXAM_PROCEDURE", title: "檢查檢驗方法", hidden: true },
                                    { field: "EXAM_REPORT01", title: "檢查檢驗結果(含參考值)", template: "#if(kendo.parseFloat(EXAM_REPORT01)<kendo.parseFloat(UNIT.substr(0,UNIT.indexOf('-')))){#<span style='color:blue;'>#=EXAM_REPORT01#</span>#}else if(kendo.parseFloat(EXAM_REPORT01)>kendo.parseFloat(UNIT.substr(UNIT.indexOf('-')+1,UNIT.length))){{#<span style='color:red;'>#=EXAM_REPORT01#</span>#}} else{#<span style='color:black;'>#=EXAM_REPORT01#</span>#}  #" },
                                    { field: "UNIT", title: "檢查檢驗方法", hidden: true },
                                    { field: "REFERENCE", title: "單位", hidden: true },
                                    { field: "EXAM_REPORT02", title: "參考值", hidden: true },
                                    { field: "SPECIMEN", title: "檢體採檢方法/來源/類別", hidden: true },
                                    { field: "ORDER_DATE", title: "開立醫令日期", hidden: true },
                                    { field: "EXECUTE_DATE", title: "採檢/實際檢查日期" },
                                    { field: "REPORT_DATE", title: "報告時間", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "CERTIFICATION", title: "有無TAF認證C/1/Y/N" },
                                    { field: "VIDEO_MATERIAL", title: "是否有影像資料/C/1/Y/N" },

                                ]
                            });
                        })


                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡SECTION_NAMEC欄位的DropDownList Change
                        ///</summary>
                        $("#DropDownListForCMDEXAMREPORTSECTION_NAMEC").change(function () {
                            //debugger
                            SECTION_NAMEC = $(this).val();
                            $("#CMDEXAMREPORT").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDEXAMREPORTSECTION_NAMECChange",
                                            data: {
                                                "SECTION_NAMEC": SECTION_NAMEC,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    serverPaging: true,
                                    serverSorting: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "EXAM_TYPE", title: "報告類別", hidden: true },
                                    { field: "SOURCE", title: "來源:本院門診or他院門診" },
                                    { field: "NHI_YM", title: "費用年月 YYY/MM(民國年)", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼 例:00", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷主診斷名稱", hidden: true },
                                    { field: "REGION", title: "診療部位", hidden: true },
                                    { field: "EXAM_TYPE_CODE", title: "檢查檢驗類別", hidden: true },
                                    { field: "EXAM_TYPE_NAME", title: "檢查檢驗類別名稱" },
                                    { field: "NHI_CODE", title: "醫令代碼", hidden: true },
                                    { field: "NHI_NAME", title: "醫令名稱" },
                                    { field: "EXAM_NAME", title: "檢查檢驗項目", hidden: true },
                                    { field: "EXAM_PROCEDURE", title: "檢查檢驗方法", hidden: true },
                                    { field: "EXAM_REPORT01", title: "檢查檢驗結果(含參考值)", template: "#if(kendo.parseFloat(EXAM_REPORT01)<kendo.parseFloat(UNIT.substr(0,UNIT.indexOf('-')))){#<span style='color:blue;'>#=EXAM_REPORT01#</span>#}else if(kendo.parseFloat(EXAM_REPORT01)>kendo.parseFloat(UNIT.substr(UNIT.indexOf('-')+1,UNIT.length))){{#<span style='color:red;'>#=EXAM_REPORT01#</span>#}} else{#<span style='color:black;'>#=EXAM_REPORT01#</span>#}  #" },
                                    { field: "UNIT", title: "檢查檢驗方法", hidden: true },
                                    { field: "REFERENCE", title: "單位", hidden: true },
                                    { field: "EXAM_REPORT02", title: "參考值", hidden: true },
                                    { field: "SPECIMEN", title: "檢體採檢方法/來源/類別", hidden: true },
                                    { field: "ORDER_DATE", title: "開立醫令日期", hidden: true },
                                    { field: "EXECUTE_DATE", title: "採檢/實際檢查日期" },
                                    { field: "REPORT_DATE", title: "報告時間", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "CERTIFICATION", title: "有無TAF認證C/1/Y/N" },
                                    { field: "VIDEO_MATERIAL", title: "是否有影像資料/C/1/Y/N" },

                                ]
                            });
                        })

                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡EXAM_TYPE_NAME欄位的DropDownList Change
                        ///</summary>
                        $("#DropDownListForCMDEXAMREPORTEXAM_TYPE_NAME").change(function () {
                            //debugger
                            EXAM_TYPE_NAME = $(this).val();
                            $("#CMDEXAMREPORT").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDEXAMREPORTEXAM_TYPE_NAMEChange",
                                            data: {
                                                "EXAM_TYPE_NAME": EXAM_TYPE_NAME,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    serverPaging: true,
                                    serverSorting: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "EXAM_TYPE", title: "報告類別", hidden: true },
                                    { field: "SOURCE", title: "來源:本院門診or他院門診" },
                                    { field: "NHI_YM", title: "費用年月 YYY/MM(民國年)", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼 例:00", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷主診斷名稱", hidden: true },
                                    { field: "REGION", title: "診療部位", hidden: true },
                                    { field: "EXAM_TYPE_CODE", title: "檢查檢驗類別", hidden: true },
                                    { field: "EXAM_TYPE_NAME", title: "檢查檢驗類別名稱" },
                                    { field: "NHI_CODE", title: "醫令代碼", hidden: true },
                                    { field: "NHI_NAME", title: "醫令名稱" },
                                    { field: "EXAM_NAME", title: "檢查檢驗項目", hidden: true },
                                    { field: "EXAM_PROCEDURE", title: "檢查檢驗方法", hidden: true },
                                    { field: "EXAM_REPORT01", title: "檢查檢驗結果(含參考值)", template: "#if(kendo.parseFloat(EXAM_REPORT01)<kendo.parseFloat(UNIT.substr(0,UNIT.indexOf('-')))){#<span style='color:blue;'>#=EXAM_REPORT01#</span>#}else if(kendo.parseFloat(EXAM_REPORT01)>kendo.parseFloat(UNIT.substr(UNIT.indexOf('-')+1,UNIT.length))){{#<span style='color:red;'>#=EXAM_REPORT01#</span>#}} else{#<span style='color:black;'>#=EXAM_REPORT01#</span>#}  #" },
                                    { field: "UNIT", title: "檢查檢驗方法", hidden: true },
                                    { field: "REFERENCE", title: "單位", hidden: true },
                                    { field: "EXAM_REPORT02", title: "參考值", hidden: true },
                                    { field: "SPECIMEN", title: "檢體採檢方法/來源/類別", hidden: true },
                                    { field: "ORDER_DATE", title: "開立醫令日期", hidden: true },
                                    { field: "EXECUTE_DATE", title: "採檢/實際檢查日期" },
                                    { field: "REPORT_DATE", title: "報告時間", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "CERTIFICATION", title: "有無TAF認證C/1/Y/N" },
                                    { field: "VIDEO_MATERIAL", title: "是否有影像資料/C/1/Y/N" },

                                ]
                            });
                        })

                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡EXECUTE_DATE欄位的DropDownList Change
                        ///</summary>
                        $("#DropDownListForCMDEXAMREPORTEXECUTE_DATE").change(function () {
                            //debugger
                            EXECUTE_DATE = $(this).val();
                            $("#CMDEXAMREPORT").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDEXAMREPORTEXECUTE_DATEChange",
                                            data: {
                                                "EXECUTE_DATE": EXECUTE_DATE,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    serverPaging: true,
                                    serverSorting: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "EXAM_TYPE", title: "報告類別", hidden: true },
                                    { field: "SOURCE", title: "來源:本院門診or他院門診" },
                                    { field: "NHI_YM", title: "費用年月 YYY/MM(民國年)", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼 例:00", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷主診斷名稱", hidden: true },
                                    { field: "REGION", title: "診療部位", hidden: true },
                                    { field: "EXAM_TYPE_CODE", title: "檢查檢驗類別", hidden: true },
                                    { field: "EXAM_TYPE_NAME", title: "檢查檢驗類別名稱" },
                                    { field: "NHI_CODE", title: "醫令代碼", hidden: true },
                                    { field: "NHI_NAME", title: "醫令名稱" },
                                    { field: "EXAM_NAME", title: "檢查檢驗項目", hidden: true },
                                    { field: "EXAM_PROCEDURE", title: "檢查檢驗方法", hidden: true },
                                    { field: "EXAM_REPORT01", title: "檢查檢驗結果(含參考值)", template: "#if(kendo.parseFloat(EXAM_REPORT01)<kendo.parseFloat(UNIT.substr(0,UNIT.indexOf('-')))){#<span style='color:blue;'>#=EXAM_REPORT01#</span>#}else if(kendo.parseFloat(EXAM_REPORT01)>kendo.parseFloat(UNIT.substr(UNIT.indexOf('-')+1,UNIT.length))){{#<span style='color:red;'>#=EXAM_REPORT01#</span>#}} else{#<span style='color:black;'>#=EXAM_REPORT01#</span>#}  #" },
                                    { field: "UNIT", title: "檢查檢驗方法", hidden: true },
                                    { field: "REFERENCE", title: "單位", hidden: true },
                                    { field: "EXAM_REPORT02", title: "參考值", hidden: true },
                                    { field: "SPECIMEN", title: "檢體採檢方法/來源/類別", hidden: true },
                                    { field: "ORDER_DATE", title: "開立醫令日期", hidden: true },
                                    { field: "EXECUTE_DATE", title: "採檢/實際檢查日期" },
                                    { field: "REPORT_DATE", title: "報告時間", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "CERTIFICATION", title: "有無TAF認證C/1/Y/N" },
                                    { field: "VIDEO_MATERIAL", title: "是否有影像資料/C/1/Y/N" },

                                ]
                            });
                        })

                        ///<summary>
                        ///程式說明：CMDEXAMREPORT Table裡SOURCE欄位的MultiSelect Change
                        ///</summary>
                        $("#CMDEXAMREPORTmultiselect").change(function () {
                                //alert(CMDEXAMREPORTmultiselect.value())
                                //SOURCE = CMDEXAMREPORTmultiselect.value();
                                $("#CMDEXAMREPORT").kendoGrid({
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "POST",
                                                url: "CMDEXAMREPORTSOURCEMultiSelectChange",
                                                data: {
                                                    SOURCE: function () {
                                                        return CMDEXAMREPORTmultiselect.value();
                                                    },
                                                    PatientId: function () {
                                                        return $("#Patienttextbox").val();
                                                    }
                                                },
                                                dataType: "json"
                                            }
                                        },
                                        pageSize: 20,
                                        toolbarColumnMenu: true
                                    },
                                    columnMenu: {
                                        messages: {
                                            columns: "顯示欄位設定",

                                        }
                                    },
                                    columns: [
                                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                                        { field: "EXAM_TYPE", title: "報告類別", hidden: true },
                                        { field: "SOURCE", title: "來源" },
                                        { field: "NHI_YM", title: "費用年月 YYY/MM(民國年)", hidden: true },
                                        { field: "SECTION", title: "就醫科別代碼 例:00", hidden: true },
                                        { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                        { field: "MAIN_DIAGNOSIS", title: "主診斷", hidden: true },
                                        { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷主診斷名稱", hidden: true },
                                        { field: "REGION", title: "診療部位", hidden: true },
                                        { field: "EXAM_TYPE_CODE", title: "檢查檢驗類別", hidden: true },
                                        { field: "EXAM_TYPE_NAME", title: "檢查檢驗類別名稱" },
                                        { field: "NHI_CODE", title: "醫令代碼", hidden: true },
                                        { field: "NHI_NAME", title: "醫令名稱" },
                                        { field: "EXAM_NAME", title: "檢查檢驗項目", hidden: true },
                                        { field: "EXAM_PROCEDURE", title: "檢查檢驗方法", hidden: true },
                                        { field: "EXAM_REPORT01", title: "檢查檢驗結果(含參考值)", template: "#if(kendo.parseFloat(EXAM_REPORT01)<kendo.parseFloat(UNIT.substr(0,UNIT.indexOf('-')))){#<span style='color:blue;'>#=EXAM_REPORT01#</span>#}else if(kendo.parseFloat(EXAM_REPORT01)>kendo.parseFloat(UNIT.substr(UNIT.indexOf('-')+1,UNIT.length))){{#<span style='color:red;'>#=EXAM_REPORT01#</span>#}} else{#<span style='color:black;'>#=EXAM_REPORT01#</span>#}  #" },
                                        { field: "UNIT", title: "檢查檢驗方法", hidden: true },
                                        { field: "REFERENCE", title: "單位", hidden: true },
                                        { field: "EXAM_REPORT02", title: "參考值" },
                                        { field: "SPECIMEN", title: "檢體採檢方法/來源/類別", hidden: true },
                                        { field: "ORDER_DATE", title: "開立醫令日期", hidden: true },
                                        { field: "EXECUTE_DATE", title: "採檢/實際檢查日期" },
                                        { field: "REPORT_DATE", title: "報告時間", hidden: true },
                                        { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                        { field: "CERTIFICATION", title: "有無TAF認證C/1/Y/N" },
                                        { field: "VIDEO_MATERIAL", title: "是否有影像資料/C/1/Y/N", template: '<a href="https://images.app.goo.gl/cki1yNBfgagqXsu47" target="_blank">#=VIDEO_MATERIAL#</a>' },
                                    ], //columns的field對應到customer資料表的欄位
                                });
                        })

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡HOSPITAL_ID欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForCMDBDRCHOSPITAL_ID").change(function () {
                            //debugger
                            HOSPITAL_ID = $(this).val();
                            $("#CMDBDRC").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDBDRCHOSPITAL_IDChange",
                                            data: {
                                                "HOSPITAL_ID": HOSPITAL_ID,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱"},
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "檢查項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })


                        ///<summary>
                        ///程式說明：CMDBDRC Table裡SECTION_NAMEC欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForCMDBDRCSECTION_NAMEC").change(function () {
                            //debugger
                            SECTION_NAMEC = $(this).val();
                            $("#CMDBDRC").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDBDRCSECTION_NAMECChange",
                                            data: {
                                                "SECTION_NAMEC": SECTION_NAMEC,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "檢查項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡REC_NAME欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForCMDBDRCREC_NAME").change(function () {
                            //debugger
                            REC_NAME = $(this).val();
                            $("#CMDBDRC").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDBDRCREC_NAMEChange",
                                            data: {
                                                "REC_NAME": REC_NAME,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "檢查項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡NHI_NAME欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForCMDBDRCNHI_NAME").change(function () {
                            //debugger
                            NHI_NAME = $(this).val();
                            $("#CMDBDRC").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDBDRCNHI_NAMEChange",
                                            data: {
                                                "NHI_NAME": NHI_NAME,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "檢查項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡EXECUTE_DATE欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForCMDBDRCEXECUTE_DATE").change(function () {
                            //debugger
                            EXECUTE_DATE = $(this).val();
                            $("#CMDBDRC").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDBDRCEXECUTE_DATEChange",
                                            data: {
                                                "EXECUTE_DATE": EXECUTE_DATE,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "檢查項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：CMDBDRC Table裡SOURCE欄位的MultiSelecct Change
                        ///</summary>
                        $("#CMDBDRCmultiselect").change(function () {
                                //alert(CMDBDRCmultiselect.value())
                                //SOURCE = CMDBDRCmultiselect.value();
                                $("#CMDBDRC").kendoGrid({
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "POST",
                                                url: "CMDBDRCSOURCEMultiSelectChange",
                                                data: {
                                                    SOURCE: function () {
                                                        return CMDBDRCmultiselect.value();
                                                    },
                                                    PatientId: function () {
                                                        return $("#Patienttextbox").val();
                                                    }
                                                },
                                                dataType: "json"
                                            }
                                        },
                                        pageSize: 20,
                                        toolbarColumnMenu: true
                                    },
                                    columnMenu: {
                                        messages: {
                                            columns: "顯示欄位設定",

                                        }
                                    },
                                    columns: [
                                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                        { field: "REC_TYPE", title: "項目類別", hidden: true },
                                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                                        { field: "SOURCE", title: "來源" },
                                        { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                        { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                        { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                        { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                        { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱"},
                                        { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                        { field: "REC_NAME", title: "檢查項目名稱" },
                                        { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                        { field: "NHI_NAME", title: "健保名稱診療部位" },
                                        { field: "REGION", title: "部位", hidden: true },
                                        { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                        { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                        { field: "QTY", title: "醫令總量", hidden: true },
                                        { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                        { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                        { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                        { field: "OPDDATE", title: "診療部位", hidden: true },
                                        { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                    ], //columns的field對應到customer資料表的欄位
                                });
                        })

                        ///<summary>
                        ///程式說明：OPERATION 裡HOSPITAL_ID欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForOPERATIONHOSPITAL_ID").change(function () {
                            //debugger
                            PatientId = $("#Patienttextbox").val();
                            HOSPITAL_ID = $(this).val();
                            $("#OPERATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "OPERATIONHOSPITAL_IDChange",
                                            data: {
                                                "HOSPITAL_ID": HOSPITAL_ID,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱"},
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })


                        ///<summary>
                        ///程式說明：OPERATION Table裡SECTION_NAMEC欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForOPERATIONSECTION_NAMEC").change(function () {
                            //debugger
                            SECTION_NAMEC = $(this).val();
                            $("#OPERATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "OPERATIONSECTION_NAMECChange",
                                            data: {
                                                "SECTION_NAMEC": SECTION_NAMEC,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱"},
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：OPERATION Table裡REC_NAME欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForOPERATIONREC_NAME").change(function () {
                            //debugger
                            REC_NAME = $(this).val();
                            $("#OPERATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "OPERATIONREC_NAMEChange",
                                            data: {
                                                "REC_NAME": REC_NAME,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：OPERATION Table裡NHI_NAME欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForOPERATIONNHI_NAME").change(function () {
                            //debugger
                            NHI_NAME = $(this).val();
                            $("#OPERATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "OPERATIONNHI_NAMEChange",
                                            data: {
                                                "NHI_NAME": NHI_NAME,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：OPERATION Table裡EXECUTE_DATE欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForOPERATIONEXECUTE_DATE").change(function () {
                            //debugger
                            EXECUTE_DATE = $(this).val();
                            $("#OPERATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "OPERATIONEXECUTE_DATEChange",
                                            data: {
                                                "EXECUTE_DATE": EXECUTE_DATE,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：OPERATION Table裡SOURCE欄位的MultiSelecct Change
                        ///</summary>
                        $("#OPERATIONmultiselect").change(function () {
                                //alert(OPERATIONmultiselect.value())
                                //SOURCE = OPERATIONmultiselect.value();
                                $("#OPERATION").kendoGrid({
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "POST",
                                                url: "OPERATIONSOURCEMultiSelectChange",
                                                data: {
                                                    SOURCE: function () {
                                                        return OPERATIONmultiselect.value();
                                                    },
                                                    PatientId: function () {
                                                        return $("#Patienttextbox").val();
                                                    }
                                                },
                                                dataType: "json"
                                            }
                                        },
                                        pageSize: 20,
                                        toolbarColumnMenu: true
                                    },
                                    columnMenu: {
                                        messages: {
                                            columns: "顯示欄位設定",

                                        }
                                    },
                                    columns: [
                                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                        { field: "REC_TYPE", title: "項目類別", hidden: true },
                                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                                        { field: "SOURCE", title: "來源" },
                                        { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                        { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                        { field: "SECTION_NAMEC", title: "就醫科別名稱" },
                                        { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                        { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                        { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                        { field: "REC_NAME", title: "項目名稱" },
                                        { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                        { field: "NHI_NAME", title: "健保名稱診療部位" },
                                        { field: "REGION", title: "部位", hidden: true },
                                        { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                        { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                        { field: "QTY", title: "醫令總量", hidden: true },
                                        { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                        { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                        { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                        { field: "OPDDATE", title: "診療部位", hidden: true },
                                        { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                    ], //columns的field對應到customer資料表的欄位
                                });
                        })

                        ///<summary>
                        ///程式說明：DENTISTRY 裡HOSPITAL_ID欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForDENTISTRYHOSPITAL_ID").change(function () {
                            //debugger
                            PatientId = $("#Patienttextbox").val();
                            HOSPITAL_ID = $(this).val();
                            $("#DENTISTRY").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "DENTISTRYHOSPITAL_IDChange",
                                            data: {
                                                "HOSPITAL_ID": HOSPITAL_ID,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })


                        ///<summary>
                        ///程式說明：DENTISTRY Table裡SECTION_NAMEC欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForDENTISTRYSECTION_NAMEC").change(function () {
                            //debugger
                            SECTION_NAMEC = $(this).val();
                            $("#DENTISTRY").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "DENTISTRYSECTION_NAMECChange",
                                            data: {
                                                "SECTION_NAMEC": SECTION_NAMEC,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：DENTISTRY Table裡REC_NAME欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForDENTISTRYREC_NAME").change(function () {
                            //debugger
                            REC_NAME = $(this).val();
                            $("#DENTISTRY").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "DENTISTRYREC_NAMEChange",
                                            data: {
                                                "REC_NAME": REC_NAME,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：DENTISTRY Table裡NHI_NAME欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForDENTISTRYNHI_NAME").change(function () {
                            //debugger
                            NHI_NAME = $(this).val();
                            $("#DENTISTRY").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "DENTISTRYNHI_NAMEChange",
                                            data: {
                                                "NHI_NAME": NHI_NAME,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：DENTISTRY Table裡EXECUTE_DATE欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForDENTISTRYEXECUTE_DATE").change(function () {
                            //debugger
                            EXECUTE_DATE = $(this).val();
                            $("#DENTISTRY").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "DENTISTRYEXECUTE_DATEChange",
                                            data: {
                                                "EXECUTE_DATE": EXECUTE_DATE,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                    { field: "REC_NAME", title: "項目名稱" },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：DENTISTRY Table裡SOURCE欄位的MultiSelecct Change
                        ///</summary>
                        $("#DENTISTRYmultiselect").change(function () {
                                //alert(DENTISTRYmultiselect.value())
                                //SOURCE = DENTISTRYmultiselect.value();
                                $("#DENTISTRY").kendoGrid({
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "POST",
                                                url: "DENTISTRYSOURCEMultiSelectChange",
                                                data: {
                                                    SOURCE: function () {
                                                        return DENTISTRYmultiselect.value();
                                                    },
                                                    PatientId: function () {
                                                        return $("#Patienttextbox").val();
                                                    }
                                                },
                                                dataType: "json"
                                            }
                                        },
                                        pageSize: 20,
                                        toolbarColumnMenu: true
                                    },
                                    columnMenu: {
                                        messages: {
                                            columns: "顯示欄位設定",

                                        }
                                    },
                                    columns: [
                                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                        { field: "REC_TYPE", title: "項目類別", hidden: true },
                                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                                        { field: "SOURCE", title: "來源" },
                                        { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                        { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                        { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                        { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                        { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                        { field: "REC_CODE", title: "檢查項目代碼", hidden: true },
                                        { field: "REC_NAME", title: "項目名稱" },
                                        { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                        { field: "NHI_NAME", title: "健保名稱診療部位" },
                                        { field: "REGION", title: "部位", hidden: true },
                                        { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                        { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                        { field: "QTY", title: "醫令總量", hidden: true },
                                        { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                        { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                        { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                        { field: "OPDDATE", title: "診療部位", hidden: true },
                                        { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                    ], //columns的field對應到customer資料表的欄位
                                });
                        })

                        ///<summary>
                        ///程式說明：REHABILITATION 裡HOSPITAL_ID欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForREHABILITATIONHOSPITAL_ID").change(function () {
                            //debugger
                            PatientId = $("#Patienttextbox").val();
                            HOSPITAL_ID = $(this).val();
                            $("#REHABILITATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "REHABILITATIONHOSPITAL_IDChange",
                                            data: {
                                                "HOSPITAL_ID": HOSPITAL_ID,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "治療方式" },
                                    { field: "REC_NAME", title: "項目名稱", hidden: true },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })


                        ///<summary>
                        ///程式說明：REHABILITATION Table裡SECTION_NAMEC欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForREHABILITATIONSECTION_NAMEC").change(function () {
                            //debugger
                            SECTION_NAMEC = $(this).val();
                            $("#REHABILITATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "REHABILITATIONSECTION_NAMECChange",
                                            data: {
                                                "SECTION_NAMEC": SECTION_NAMEC,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "治療方式" },
                                    { field: "REC_NAME", title: "項目名稱", hidden: true },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：REHABILITATION Table裡REC_CODE欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForREHABILITATIONREC_CODE").change(function () {
                            //debugger
                            REC_CODE = $(this).val();
                            $("#REHABILITATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "REHABILITATIONREC_CODEChange",
                                            data: {
                                                "REC_CODE": REC_CODE,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "治療方式" },
                                    { field: "REC_NAME", title: "項目名稱", hidden: true },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：REHABILITATION Table裡NHI_NAME欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForREHABILITATIONNHI_NAME").change(function () {
                            //debugger
                            NHI_NAME = $(this).val();
                            $("#REHABILITATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "REHABILITATIONNHI_NAMEChange",
                                            data: {
                                                "NHI_NAME": NHI_NAME,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "治療方式" },
                                    { field: "REC_NAME", title: "項目名稱", hidden: true },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：REHABILITATION Table裡EXECUTE_DATE欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForREHABILITATIONEXECUTE_DATE").change(function () {
                            //debugger
                            EXECUTE_DATE = $(this).val();
                            $("#REHABILITATION").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "REHABILITATIONEXECUTE_DATEChange",
                                            data: {
                                                "EXECUTE_DATE": EXECUTE_DATE,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    toolbarColumnMenu: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_TYPE", title: "項目類別", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "SOURCE", title: "來源" },
                                    { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                    { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                    { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                    { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                    { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                    { field: "REC_CODE", title: "治療方式" },
                                    { field: "REC_NAME", title: "項目名稱", hidden: true },
                                    { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                    { field: "NHI_NAME", title: "健保名稱診療部位" },
                                    { field: "REGION", title: "部位", hidden: true },
                                    { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                    { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                    { field: "QTY", title: "醫令總量", hidden: true },
                                    { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                    { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    { field: "OPDDATE", title: "診療部位", hidden: true },
                                    { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                ], //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：REHABILITATION Table裡SOURCE欄位的MultiSelecct Change
                        ///</summary>
                        $("#REHABILITATIONmultiselect").change(function () {
                                //alert(REHABILITATIONmultiselect.value())
                                //SOURCE = REHABILITATIONmultiselect.value();
                                $("#REHABILITATION").kendoGrid({
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "POST",
                                                url: "REHABILITATIONSOURCEMultiSelectChange",
                                                data: {
                                                    SOURCE: function () {
                                                        return REHABILITATIONmultiselect.value();
                                                    },
                                                    PatientId: function () {
                                                        return $("#Patienttextbox").val();
                                                    }
                                                },
                                                dataType: "json"
                                            }
                                        },
                                        pageSize: 20,
                                        toolbarColumnMenu: true
                                    },
                                    columnMenu: {
                                        messages: {
                                            columns: "顯示欄位設定",

                                        }
                                    },
                                    columns: [
                                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                        { field: "REC_TYPE", title: "項目類別", hidden: true },
                                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                                        { field: "SOURCE", title: "來源" },
                                        { field: "NHI_YM", title: "NHI_YM", hidden: true },
                                        { field: "SECTION", title: "就醫科別代碼", hidden: true },
                                        { field: "SECTION_NAMEC", title: "就醫科別名稱", hidden: true },
                                        { field: "MAIN_DIAGNOSIS", title: "主診斷碼", hidden: true },
                                        { field: "MAIN_DIAGNOSIS_NAME", title: "主診斷名稱" },
                                        { field: "REC_CODE", title: "治療方式" },
                                        { field: "REC_NAME", title: "項目名稱", hidden: true },
                                        { field: "NHI_CODE", title: "健保代碼", hidden: true },
                                        { field: "NHI_NAME", title: "健保名稱診療部位" },
                                        { field: "REGION", title: "部位", hidden: true },
                                        { field: "EXECUTE_DATE", title: "收件日期", template: '#= kendo.toString(kendo.parseDate(EXECUTE_DATE), "yyyy/MM/dd")#' },
                                        { field: "REPORT_DATE", title: "檢驗報告日期", template: '#= kendo.toString(kendo.parseDate(REPORT_DATE), "yyyy/MM/dd")#', hidden: true },
                                        { field: "QTY", title: "醫令總量", hidden: true },
                                        { field: "CANCEL_YN", title: "記錄取消碼", hidden: true },
                                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                        { field: "ENCNT_DATE_START", title: "就醫日期（住院日期）", hidden: true },
                                        { field: "ENCNT_DATE_END", title: "診療結束日期", hidden: true },
                                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                        { field: "OPDDATE", title: "診療部位", hidden: true },
                                        { field: "TREATMENT_SITE", title: "就醫/檢查日期", hidden: true },
                                    ], //columns的field對應到customer資料表的欄位
                                });
                        })

                        ///<summary>
                        ///程式說明：CMDALLERGY Table裡HOSPITAL_ID欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForCMDALLERGYHOSPITAL_ID").change(function () {
                            //debugger
                            HOSPITAL_ID = $(this).val();
                            $("#CMDALLERGY").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDALLERGYHOSPITAL_IDChange",
                                            data: {
                                                "HOSPITAL_ID": HOSPITAL_ID,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    serverPaging: true,
                                    serverSorting: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "UPLOAD_DTTM", title: "CASE_NO", hidden: true },
                                    { field: "SOURCE", title: "門住診別" },
                                    { field: "SOURCE_IDNO", title: "ATC7代碼", hidden: true },
                                    { field: "UPLOAD_MARK", title: "ATC5名稱", hidden: true },
                                    { field: "DRUG", title: "過敏藥物" },
                                    { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                ] //columns的field對應到customer資料表的欄位
                            });
                        })

                        ///<summary>
                        ///程式說明：CMDALLERGY Table裡SOURCE欄位的MultiSelect Change
                        ///</summary>
                        $("#CMDALLERGYmultiselect").change(function () {
                                //alert(CMDALLERGYmultiselect.value())
                                //SOURCE = CMDALLERGYmultiselect.value();
                                $("#CMDALLERGY").kendoGrid({
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "POST",
                                                url: "CMDALLERGYSOURCEMultiSelectChange",
                                                data: {
                                                    SOURCE: function () {
                                                        return CMDALLERGYmultiselect.value();
                                                    },
                                                    PatientId: function () {
                                                        return $("#Patienttextbox").val();
                                                    }
                                                },
                                                dataType: "json"
                                            }
                                        },
                                        pageSize: 20,
                                        serverPaging: true,
                                        serverSorting: true
                                    },
                                    columnMenu: {
                                        messages: {
                                            columns: "顯示欄位設定",

                                        }
                                    },
                                    columns: [
                                        { field: "HOSPITAL_ID", title: "醫院名稱" },
                                        { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                        { field: "REC_NO", title: "自訂流水號", hidden: true },
                                        { field: "UPLOAD_DTTM", title: "CASE_NO", hidden: true },
                                        { field: "SOURCE", title: "門住診別" },
                                        { field: "SOURCE_IDNO", title: "ATC7代碼", hidden: true },
                                        { field: "UPLOAD_MARK", title: "ATC5名稱", hidden: true },
                                        { field: "DRUG", title: "過敏藥物" },
                                        { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                        { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                        { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                        { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                        { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                        { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                        { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                        { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                        { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                        { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                        { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                        { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                    ], //columns的field對應到customer資料表的欄位
                                });
                        })


                        ///<summary>
                        ///程式說明：CMDALLERGY Table裡DRUG欄位的DropDownList Change
                        ///</summary>
                        $("#dropdownlistForCMDALLERGYDRUG").change(function () {
                            //debugger
                            DRUG = $(this).val();
                            $("#CMDALLERGY").kendoGrid({
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "POST",
                                            url: "CMDALLERGYDRUGChange",
                                            data: {
                                                "DRUG": DRUG,
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"
                                        }
                                    },
                                    pageSize: 20,
                                    serverPaging: true,
                                    serverSorting: true
                                },
                                columnMenu: {
                                    messages: {
                                        columns: "顯示欄位設定",

                                    }
                                },
                                columns: [
                                    { field: "HOSPITAL_ID", title: "醫院名稱" },
                                    { field: "PAT_IDNO", title: "病人代碼", hidden: true },
                                    { field: "REC_NO", title: "自訂流水號", hidden: true },
                                    { field: "UPLOAD_DTTM", title: "CASE_NO", hidden: true },
                                    { field: "SOURCE", title: "門住診別" },
                                    { field: "SOURCE_IDNO", title: "ATC7代碼", hidden: true },
                                    { field: "UPLOAD_MARK", title: "ATC5名稱", hidden: true },
                                    { field: "DRUG", title: "過敏藥物" },
                                    { field: "CANCEL_YN", title: "記錄取消碼 N.未取消", hidden: true },
                                    { field: "CANCEL_DTTM", title: "記錄取消日期/時間", hidden: true },
                                    { field: "CANCEL_USER_ID", title: "記錄取消人員IDNo", hidden: true },
                                    { field: "CANCEL_NAMEC", title: "記錄取消人員姓名", hidden: true },
                                    { field: "PROC_DTTM", title: "記錄處理日期/時間", hidden: true },
                                    { field: "PROC_USER_ID", title: "記錄處理人員IDNo", hidden: true },
                                    { field: "PROC_NAMEC", title: "記錄處理人員姓名", hidden: true },
                                    { field: "CREATE_DTTM", title: "記錄建立日期/時間", hidden: true },
                                    { field: "CREATE_USER_ID", title: "記錄建立人員IDNo", hidden: true },
                                    { field: "CREATE_NAMEC", title: "記錄建立人員姓名", hidden: true },
                                    { field: "HOSPITAL_ID_ORI", title: "醫事機構代碼", hidden: true },
                                    { field: "HOSPITAL_SNAME_ORI", title: "醫事機構簡稱", hidden: true },
                                ] //columns的field對應到customer資料表的欄位
                            });
                        })




                        ///<summary>
                        ///程式說明：點擊顯示餘藥按鈕後，新增餘藥日數畫面
                        ///</summary>

                        $("#ChartButton").click(function () {
                            $("#ChartWindow").data("kendoWindow").open();
                            $("#ChartWindow").data("kendoWindow").center();
                        })

                        $("#ChartWindow").kendoWindow({
                            width: "80%",
                            modal: true,
                            actions: ["Pin", "Minimize", "Maximize", "Close"],
                            visible: false
                        })

                        ///<summary>
                        ///程式說明：取得餘藥日數的Chart
                        ///</summary>
                        $("#chart").kendoChart({
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "POST",
                                        url: "GetPHRCDRCChart",
                                        data: {
                                            PatientId: function () {
                                                return $("#Patienttextbox").val();
                                            }
                                        },
                                        dataType: "json"
                                    }
                                },
                            },
                            chartArea: {
                                width: 1200,
                                height: 400
                            },
                            title: {
                                text: "餘藥日數"
                            },
                            legend: {
                                visible: false,
                            },
                            seriesDefaults: {
                                type: "bar",
                            },
                            seriesColors: ["brown"],
                            series: [{
                                field: "REMAIN",
                                categoryField: "DRUGCOMPCODENM",
                                name: "DRUG",
                            },],
                            //軸值選項
                            valueAxis: {
                                max: 30,
                                line: {
                                    visible: false
                                },
                                minorGridLines: {
                                    visible: true
                                },
                                labels: {
                                    rotation: "auto",
                                    font: "15px sans-serif",
                                },
                                color: "red"
                            },
                            categoryAxis: {
                                categories: "DRUGCOMPCODENM",
                                majorGridLines: {
                                    visible: false
                                },
                                labels: {
                                    font: "15px sans-serif",
                                },
                            },
                            tooltip: {
                                visible: true,
                                template: "#= category #餘藥日數: #= value #"
                            },
                        });


                        ///<summary>
                        ///程式說明：點擊顯示用藥區間按鈕後，新增用藥區間畫面
                        ///</summary>
                        $("#GraphicGiveDrugButton").click(function () {
                            $("#WindowForGraphicGiveDrug").data("kendoWindow").open();
                            $("#WindowForGraphicGiveDrug").data("kendoWindow").center();
                        })

                        $("#WindowForGraphicGiveDrug").kendoWindow({
                            title: "用藥區間",
                            minWidth: "80%",
                            modal: true,
                            actions: ["Pin", "Minimize", "Maximize", "Close"],
                            visible: false,
                            position: {
                                top: "10%",
                            },
                            modal: true,
                            animation: {
                            }
                        })

                        ///<summary>
                        ///程式說明：取得用藥區間的Chart
                        ///</summary>
                        var date = new Date(), y = date.getFullYear(), m = date.getMonth(), d = date.getDate();
                        var firstDay = new Date(y, m, d-30);
                        var today = new Date();


                        var colorOptions = ["red", "green", "blue", "purple"];
                        var currIdx = 0;
                        var colorMapping = {};
                        function getColor(DRUGCOMPCODENM) {
                            if (!colorMapping[DRUGCOMPCODENM]) {
                                colorMapping[DRUGCOMPCODENM] = colorOptions[currIdx++];
                            }
                            return colorMapping[DRUGCOMPCODENM];
                        }

                            $("#RangeBarChart").kendoChart({
                                chartArea: {
                                    width: 1500,
                                    height: 400
                                },
                                dataSource: {
                                    transport: {
                                        read: {
                                            type: "post",
                                            url: "GetRangeBarChart",
                                            data: {
                                                PatientId: function () {
                                                    return $("#Patienttextbox").val();
                                                }
                                            },
                                            dataType: "json"                        }
                                    },
                                    group: {
                                        field: "ID",
                                        dir: "desc"
                                    },
                                    schema: {
                                        model: {
                                            fields: {
                                                BEGIN_DT: {
                                                    type: "date"
                                                },
                                                END_DT: {
                                                    type: "date"
                                                }
                                            }
                                        }
                                    }
                                },
                                legend: {
                                    position: "top",
                                    visible: false
                                },
                                seriesDefaults: {
                                    type: "rangeBar"
                                },
                                series:
                                    [{
                                        fromField: "BEGIN_DT",
                                        toField: "END_DT",
                                        categoryField: "DRUGCOMPCODENM",
                                        name: "用藥區間",
                                        spacing: -1,
                                        color: function (color) {

                                            let array = [color.dataItem]
                                            let names = array.map(item => item.DRUGCOMPCODENM)
                                            let uniqueArr = [...new Set(names)]
                                            uniqueArr.forEach(function (DRUGCOMPCODENM) {
                                                console.log(DRUGCOMPCODENM + "->" + getColor(DRUGCOMPCODENM));
                                            }); 

                                            return getColor(color.category);
                                        }

                                    }],
                                tooltip: {
                                    visible: true,
                                    template: "#= category # 用藥天數： #=dataItem.DAYS #"
                                },
                                valueAxis: {
                                    //category:"DRUGNAME",
                                    min: firstDay.getTime(),
                                    max: today.getTime(),
                                    //majorUnit: 24 * 60 * 60 * 1000,
                                    labels: {
                                        template: "#= kendo.toString(new Date(value), 'MM/dd') #"
                                    },
                                    crosshair: {
                                        visible: true,
                                        tooltip: {
                                            visible: true,
                                            shared: true,
                                            template: kendo.template("#= kendo.toString(new Date(value),'yyyy/MM/dd') #")
                                        },
                                    }
                                },
                                categoryAxis: {
                                    line: {
                                        visible: false
                                    }
                                },
                            });

 

                            $('input:radio[name=baseUnit]').change(function () {
                                if (this.value == 'halfyears') {
                                    firstDay = new Date(y, m - 6, 1);
                                    //alert('halfyears' + firstDay.toString());
                                    var chart = $("#RangeBarChart").data("kendoChart"),
                                        valueAxis = chart.options.valueAxis;
                                    valueAxis.min = firstDay.getTime();
                                    chart.refresh();
                                }

                                else if (this.value == 'threemonths') {
                                    firstDay = new Date(y, m - 3, 1);
                                    //alert('threeyears' + firstDay.toString());
                                    var chart = $("#RangeBarChart").data("kendoChart"),
                                        valueAxis = chart.options.valueAxis;
                                    valueAxis.min = firstDay.getTime();
                                    chart.refresh();
                                }
                                else if (this.value == 'months') {
                                    firstDay = new Date(y, m, d - 30);
                                    //alert('months' + firstDay.toString());
                                    var chart = $("#RangeBarChart").data("kendoChart"),
                                        valueAxis = chart.options.valueAxis;
                                    valueAxis.min = firstDay.getTime();
                                    chart.refresh();
                                }
                                else if (this.value == 'weeks') {
                                    firstDay = new Date(y, m, d - 7);
                                    //alert('weeks' + firstDay.toString());
                                    var chart = $("#RangeBarChart").data("kendoChart"),
                                        valueAxis = chart.options.valueAxis;
                                    valueAxis.min = firstDay.getTime();
                                    chart.refresh();
                                }
                            });
                    }
                });
            })
        });
    </script>


    <style>
        .warning {
            color: #FF0000
        }

        .critical {
            color: #0000FF
        }

        .ok {
            color: #000000
        }
    </style>

    <style type="text/css">

        #header {
            padding: 10px;
            background-image: url(/Images/f-hos-logo.png), /*radial-gradient(circle, #FFE4CA 0%, #C4E1FF);*/
            linear-gradient(to left,#FFE4CA, #C4E1FF);
            background-repeat: no-repeat, no-repeat;
            background-position: 2% 3%, right;
            background-size: 150px 150px,cover;
            background-attachment: fixed;
            line-height: 50px;
            text-align: center;
            font-family: Fantasy;
            font-weight: 900;
            font-size: 0.8rem;
            color: #003D79;
            letter-spacing: 5px;
            border: 1px #ccc solid;
        }

        p1 {
            color: #FF2D2D;
            font-weight: bolder;
            font-size: 1.2rem;
            position: relative;
        }

        #Patient {
            position: relative;
            margin-top: 20px;
        }

        #tabstrip {
            position: relative;
            margin-top: 20px;
        }

        #tabstrip ul {
            color: #0080FF;
            font-weight: 700;
            font-size: 1.1em;
        }

        #Patienttextbox {
            border-radius: 5px;
            border: 2px solid #ADADAD;
            background-image: url('/Images/searchicon.png');
            background-repeat: no-repeat;
            background-size: 15%;
        }

        text {
            color: #3C3C3C;
            font-weight: 600;
        }

        #choose {
            margin-top: 20px;
            margin-bottom: 20px;
        }

        #hospitalpicture {
            left: 10px;
        }

        .k-button {
            background-color: #64a1d5;
            background-image: linear-gradient(to bottom, #64a1d5, #428bca);
            color: #fff;
            border-color: #428bca;
            min-width: 70px;
        }

        .k-button:hover {
            background-color: #F75000;
            color: #fff;
            border-color: #D2E9FF;
        }

        #ChartButton {
            background-color: #64a1d5;
            background-image: linear-gradient(to bottom, #64a1d5, #428bca);
            color: #fff;
            border-color: #428bca;
            min-width: 80px;
        }

        #ChartButton:hover {
            background-color: #F75000;
            color: #fff;
            border-color: #D2E9FF;
        }


    </style>

}
